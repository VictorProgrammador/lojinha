var app=angular.module("myApp",["ngSanitize","ui.select","ngTouch","ui.bootstrap","angular-loading-bar","ngAnimate","ngAria","ngMaterial","ngFileUpload","ngImgCrop","ui.mask","jkAngularRatingStars","ngLocale"]).config(["cfpLoadingBarProvider",function(n){n.parentSelector="#loading-bar-container";n.spinnerTemplate='<div style=text-align:center;><img src="/Spinerr.svg"/ height="100px"><\/div>'}]);app.config(["uiSelectConfig",function(n){n.theme="selectize"}]);app.factory("basicService",["$http",function(n){const t={"Content-Type":"application/json"};return{sendPassword:function(i){return n.post("/Home/SendPassword",i,t)},registerUser:function(i){return n.post("/Home/Register",i,t)},loginUser:function(i){return n.post("/Home/Login",i,t)},getCategories:function(){return n.get("/Home/GetCategories")},getMyProfile:function(){return n.get("/User/GetMyProfile")},getProfile:function(i){return n.post("/Home/GetProfile",i,t)},getPersonsBusiness:function(i){return n.post("/Home/GetPersonsBusiness",i,t)},getProducts:function(i){return n.post("/Home/GetProducts",i,t)},saveMyProfile:function(i){return n.post("/User/SaveMyProfile",i,t)},updatePersonPhoto:function(t,i){return n.post("/User/UpdatePersonPhoto",t,i)},updatePersonBannerPhoto:function(t,i){return n.post("/User/UpdatePersonBannerPhoto",t,i)},saveMyBusiness:function(i){return n.post("/User/SaveMyBusiness",i,t)},saveBusinessClassification:function(i){return n.post("/Home/SaveBusinessClassification",i,t)},getRateProfileByPerson:function(i){return n.post("/Home/GetRateProfileByPerson",i,t)},getMyProducts:function(i){return n.post("/User/GetMyProducts",i,t)},getPersonBusinessProducts:function(i){return n.post("/Home/GetPersonBusinessProducts",i,t)},getMyComplements:function(i){return n.post("/User/GetMyComplements",i,t)},getMyRaffles:function(i){return n.post("/User/GetMyRaffles",i,t)},getRaffleParticipants:function(i){return n.post("/User/GetRaffleParticipants",i,t)},getProfileRaffles:function(i){return n.post("/Home/GetProfileRaffles",i,t)},savePersonBusinessCheckin:function(i){return n.post("/Home/SavePersonBusinessCheckin",i,t)},getMyArchives:function(i){return n.post("/User/GetMyArchives",i,t)},getPersonBusinessArchives:function(i){return n.post("/Home/GetPersonBusinessArchives",i,t)},createOrder:function(i){return n.post("/CheckoutApi/CreateOrder",i,t)},getProduct:function(i){return n.post("/Home/GetProduct",i,t)},saveProductCart:function(i){return n.post("/Home/SaveProductCart",i,t)},getCart:function(i){return n.post("/User/GetCart",i,t)},excludeCartProduct:function(i){return n.post("/User/ExcludeCartProduct",i,t)},searchCEP:function(i){return n.post("/User/SearchCEP",i,t)},createOrder:function(i){return n.post("/User/CreateOrder",i,t)},getOrder:function(i){return n.post("/User/GetOrder",i,t)},getOrders:function(i){return n.post("/User/GetOrders",i,t)}}}]),function(){"use strict";function t(t,i,r){fetch(i,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(n=>{if(n.ok)return n.text();throw new Error(`${n.status} ${n.statusText} ${n.url}`);}).then(n=>{if(t.querySelector(".loading").classList.remove("d-block"),n.trim()=="OK")t.querySelector(".sent-message").classList.add("d-block"),t.reset();else throw new Error(n?n:"Form submission failed and no error message returned from: "+i);}).catch(i=>{n(t,i)})}function n(n,t){n.querySelector(".loading").classList.remove("d-block");n.querySelector(".error-message").innerHTML=t;n.querySelector(".error-message").classList.add("d-block")}let i=document.querySelectorAll(".php-email-form");i.forEach(function(i){i.addEventListener("submit",function(i){i.preventDefault();let r=this,u=r.getAttribute("action"),e=r.getAttribute("data-recaptcha-site-key");if(!u){n(r,"The form action property is not set!");return}r.querySelector(".loading").classList.add("d-block");r.querySelector(".error-message").classList.remove("d-block");r.querySelector(".sent-message").classList.remove("d-block");let f=new FormData(r);e?typeof grecaptcha!="undefined"?grecaptcha.ready(function(){try{grecaptcha.execute(e,{action:"php_email_form_submit"}).then(n=>{f.set("recaptcha-response",n),t(r,u,f)})}catch(i){n(r,i)}}):n(r,"The reCaptcha javascript API url is not loaded!"):t(r,u,f)})})}();app.controller("registerController",["$scope","basicService",function(n,t){n.user={};n.disableRegister=!1;n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.registerUser=function(){if(n.user.password!=n.user.confirmPassword)return n.addErrorAlert("As senhas devem ser idênticas!"),!1;n.disableRegister=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");t.registerUser(n.user).then(function(t){(t==undefined||t.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!"),n.disableRegister=!1);var i=t.data;i==!0?n.addSuccessAlert("Sucesso! Seus dados de acesso foram enviados ao seu e-mail!"):(n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!"),i.errorList!=null&&i.errorList.length>0&&i.errorList.map(function(t){n.addErrorAlert(t)}),n.disableRegister=!1);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!");n.disableRegister=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("RecoverPasswordController",["$scope","basicService",function(n,t){n.email="";n.disableRecover=!1;n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.recoverPassword=function(){if(n.email==undefined||n.email=="")return $(".emailInput").addClass("border"),$(".emailInput").addClass("border-danger"),!1;$(".emailInput").removeClass("border");$(".emailInput").removeClass("border-danger");n.disableRecover=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");let i={username:n.email};t.sendPassword(i).then(function(t){(t==undefined||t.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!."),n.disableRecover=!1);t.data==!0?n.addSuccessAlert("Sucesso! A sua senha foi enviada no seu email."):(n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!."),n.disableRecover=!1);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!.");n.disableRecover=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("loginController",["$scope","$window","$location","basicService",function(n,t,i,r){n.user={};n.disableLogin=!1;n.showPassword=!1;n.changeShowPassword=function(){n.showPassword=!n.showPassword};n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.loginUser=function(){n.disableLogin=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.user.returnUrl=i.absUrl();r.loginUser(n.user).then(function(r){var u;if((r==undefined||r.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, falha ao realizar login!"),n.disableLogin=!1),u=r.data,u.success!=undefined&&u.success!=null&&u.success==!0){var f=i.absUrl(),e=f.split("/")[0],o=f.split("/")[2];t.location.href=u.data.startsWith("http")||u.data.startsWith("https")?e+"//"+o:e+"//"+o+u.data}else u.errorList!=null&&u.errorList.length>0&&u.errorList.map(function(t){n.addErrorAlert(t)}),n.disableLogin=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! não foi possível realizar login!");n.disableLogin=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("userProfileController",["$scope","$filter","$window","basicService","utilidadesService",function(n,t,i,r,u){var f,e;n.myCroppedImage="";n.urlProfile="";n.showImageCropped=!1;n.tabSelected=0;n.user={};n.file=null;n.categories=[];n.categoryTags=[];n.multipleDemo={};n.multipleDemo.colors=[];n.tab=1;n.currentNavItem="page1";n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.onTabSelected=function(){n.tabSelected=n.selectedIndex};n.showImageToCropped=function(){n.showImageCropped=!0;u.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte. Caso tenha carregado, após cortar, clique no botão Atualizar foto de Perfil.",!0)};n.imageLoadError=function(){u.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};f=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#fileInput")).on("change",f);n.getMyProfile=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.getMyProfile().then(function(t){var i=t.data,r,u;i!=null&&i!=undefined&&(n.user=i);n.user.profile.personBusiness!=undefined&&n.user.profile.personBusiness!=null&&(n.user.profile.personBusiness.approved==undefined||n.user.profile.personBusiness.approved==!1)&&n.addErrorAlert("Aprovação pendente, você será notificado por e-mail e via WhatsApp(caso tenha preenchido esse campo)");n.urlProfile=n.user.profile.photoUrl+"?v="+(new Date).getTime();n.user.profile.hasBanner==!0&&n.user.profile.bannerUrl!=null&&n.user.profile.bannerUrl!=""&&(r=document.querySelector(".content-img"),u="/"+n.user.profile.bannerUrl.replace(/\\/g,"/"),r.style.backgroundImage="url("+u+")");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");n.getCategories()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.saveMyProfile=function(){var t={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};if(n.user.profile.name==""||n.user.profile.name==null)return u.exibirMensagem("Atenção!","Necessário preencher o Nome!",!1),!1;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.saveMyProfile(t).then(function(n){var t=n.data;t!=undefined&&t.success==!0?u.exibirMensagem("Atenção!","Sucesso ao atualizar seu perfil!",!1):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu perfil, entre em contato com o suporte!",!1)})};e=function(){n.$apply(function(){n.bannerArchive=document.querySelector("input[name=bannerArchive]").files[0]})};angular.element(document.querySelector("#bannerArchiveId")).on("change",e);n.updatePersonBannerPhoto=function(){var t=new FormData($("#formElem")[0]),f;if(n.bannerArchive==null||n.bannerArchive==undefined)return u.exibirMensagem("Atenção!","Necessário anexar uma imagem! Aqui mesmo na aba Banner, no campo de subir arquivo.",!1),!1;t.append("file",n.bannerArchive);f={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};t.append("user",JSON.stringify(f));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.updatePersonBannerPhoto(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(n){var t=n.data;t!=undefined&&t.success==!0?(u.exibirMensagem("Atenção!","Sucesso ao atualizar seu banner!",!1),i.location.reload()):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu banner, entre em contato com o suporte!",!1)})};n.updatePersonPhoto=function(){var t=new FormData($("#formElem")[0]),f;if(n.myImage==null||n.myImage=="")return u.exibirMensagem("Atenção!","Necessário anexar uma imagem. Para isso clique na camêra e carregue um arquivo de sua preferência.",!1),!1;t.append("file",n.myCroppedImage);f={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};t.append("user",JSON.stringify(f));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.updatePersonPhoto(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(n){var t=n.data;t!=undefined&&t.success==!0?(u.exibirMensagem("Atenção!","Sucesso ao atualizar seu perfil!",!1),i.location.reload()):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu perfil, entre em contato com o suporte!",!1)})};n.getCategories=function(){r.getCategories().then(function(t){var i=t.data;if(i!=null&&i!=undefined&&(n.categories=i),n.categories!=null&&n.categories!=undefined){let t=n.categories.filter(function(t){return t.id===n.user.profile.personBusiness.categoryId})[0];t!=null&&t!=undefined&&(n.categoryTags=t.tags)}},function(){n.addErrorAlert("Falha ao carregar categorias. Entre em contato com o suporte!")})};n.changeCategory=function(){let t=n.categories.filter(function(t){return t.id===n.user.profile.personBusiness.categoryId})[0];n.user.profile.personBusiness.category!=null&&n.user.profile.personBusiness.category!=undefined&&(n.user.profile.personBusiness.category.tags=[]);n.categoryTags=t.tags};n.saveMyBusiness=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");(n.user.profile.personBusiness==undefined||n.user.profile.personBusiness==null)&&(n.user.profile.personBusiness={});n.user.profile.personBusiness.PersonId=n.user.profile.id;r.saveMyBusiness(n.user.profile.personBusiness).then(function(n){var t=n.data;t!=undefined&&t.success==!0?u.exibirMensagem("Atenção!","Sucesso ao atualizar seu negócio!",!1):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu negócio. Entre em contato com o suporte!",!1)})};n.init=function(){n.addSuccessAlert("Algumas imagens podem não funcionar devido seu formato ou tamanho, nesse caso faça upload da foto pelo computador ou entre em contato com nosso suporte.");n.getMyProfile()};n.init()}]);app.controller("userManagementProductsController",["$scope","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={products:[]};n.categories=[];n.complements=[];n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addProduct=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;console.log("complementos:",n.complements);$("#myModal").modal("show")};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};const e={"Content-Type":"application/json"};saveMyProduct=function(n,t){return i.post("/User/SaveMyProduct",n,t)};excluirProduto=function(n){return i.post("/User/ExcluirProduto",n,e)};n.getCategories=function(){u.getCategories().then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.categories=i)},function(){n.addErrorAlert("Falha ao carregar categorias. Entre em contato com o suporte!")})};n.save_click=function(){var i,r,u;n.entity.value!=null&&n.entity.value!=undefined&&typeof n.entity.value=="string"&&(i=n.entity.value.replace(".","").replace(",","."),i=parseFloat(i),n.entity.value=i);n.entity.personBusinessId=n.personBusiness.id;r=new FormData($("#formElem")[0]);(document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png"))&&r.append("file",n.myCroppedImage);u=n.entity;r.append("product",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");saveMyProduct(r,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(i){var r=i.data;n.closeModal();r==!0?f.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):f.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");t.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getComplements=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyComplements().then(function(t){var i=t.data;n.complements=i!=null&&i.length>0?i:[];$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMyProducts=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyProducts(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.products!=null&&n.personBusiness.products.results.length>0?(n.list.products=n.personBusiness.products.results,n.paginantion.totalItems=n.personBusiness.products.totalResults,n.filter.PageNumber=n.personBusiness.products.pageNumber,n.paginantion.totalPages=n.personBusiness.products.totalPages):(n.list.products=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.editProduct=function(t){n.openModal();n.entity=t};n.excludeProduct=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirProduto(t).then(function(t){var i=t.data;i==!0?f.exibirMensagem("Sucesso!","Produto excluído com sucesso.",!0):f.exibirMensagem("Falha","Falha ao excluir o produto.",!0);n.getMyProducts();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showImageToCropped=function(){n.showImageCropped=!0;f.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){f.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var o=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#imageFile")).on("change",o);n.init=function(){n.getMyProducts();n.getComplements();n.getCategories()};n.init()}]);app.controller("userManagementRaffleController",["$scope","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.participants=[];n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={raffles:[]};n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addRaffle=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;$("#myModal").modal("show")};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};const e={"Content-Type":"application/json"};saveMyRaffle=function(n,t){return i.post("/User/SaveMyRaffle",n,t)};excluirSorteio=function(n){return i.post("/User/ExcluirSorteio",n,e)};n.save_click=function(){var i,r,u;n.entity.value!=null&&n.entity.value!=undefined&&typeof n.entity.value=="string"&&(i=n.entity.value.replace(".","").replace(",","."),i=parseFloat(i),n.entity.value=i);n.entity.personBusinessId=n.personBusiness.id;r=new FormData($("#formElem")[0]);(document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png"))&&r.append("file",n.myCroppedImage);u=n.entity;r.append("raffle",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");saveMyRaffle(r,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(i){var r=i.data;n.closeModal();r==!0?f.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):f.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");t.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMyRaffles=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyRaffles(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.raffles!=null&&n.personBusiness.raffles.results.length>0?(n.list.raffles=n.personBusiness.raffles.results,n.paginantion.totalItems=n.personBusiness.raffles.totalResults,n.filter.PageNumber=n.personBusiness.raffles.pageNumber,n.paginantion.totalPages=n.personBusiness.raffles.totalPages):(n.list.raffles=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.editRaffle=function(t){n.openModal();n.entity=t};n.getRaffleParticipants=function(t){n.openParticipants();n.entity=t;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getRaffleParticipants(n.entity).then(function(t){var i=t.data;console.log("resultado",i);n.participants=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.viewParticipants=function(t){n.getRaffleParticipants(t)};n.openParticipants=function(){n.participants=[];$("#modalParticipants").modal("show")};n.closeModalParticipants=function(){n.participants=[];n.entity={};$("#modalParticipants").modal("hide")};n.excludeRaffle=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirSorteio(t).then(function(t){var i=t.data;i==!0?f.exibirMensagem("Sucesso!","Sorteio excluído com sucesso.",!0):f.exibirMensagem("Falha","Falha ao excluir o sorteio.",!0);n.getMyRaffles();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showImageToCropped=function(){n.showImageCropped=!0;f.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){f.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var o=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#imageFile")).on("change",o);n.init=function(){n.getMyRaffles()};n.init()}]);app.controller("checkinController",["$scope","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5,PersonId:0};n.paginantion={totalItems:4,totalPages:0};n.list={raffles:[],sortedNumber:[]};n.personBusiness={};n.alerts=[];n.entity={};n.disableProsseguir=!1;n.tagsConcatened="";n.progressValue=0;n.addSuccessAlert=function(t){n.alerts.push({type:"primary",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.currentStep=0;n.nextPage=function(){n.currentStep<2&&n.currentStep++};n.firstPage=function(){n.currentStep=0};n.savePersonBusinessCheckin=function(){if(n.entity.instagram==null||n.entity.instagram=="")return n.addErrorAlert("Necessário por o user do Instagram!"),!1;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.entity.personBusinessId=n.personBusiness.id;r.savePersonBusinessCheckin(n.entity).then(function(t){var i=t.data,r;i.success==!0?(n.progressValue+=1,n.addSuccessAlert(i.message),r=Object.entries(i.pedrasSorteadas),r.forEach(function(t){var i=t[0],r=t[1];n.list.sortedNumber.push({Name:i,Value:r})}),n.currentStep++):n.addErrorAlert(i.message);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");n.addErrorAlert("Erro ao fazer seu checkin!")})};n.loadProfile=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.filter.PersonId=t;r.getProfileRaffles(n.filter).then(function(t){var i=t.data,r,u;if(i!=null&&i!=undefined){if(n.personBusiness=i,n.secondRate=n.personBusiness.mediaAvaliacoes,n.personBusiness.person.photoUrl!=null&&n.personBusiness.person.photoUrl!=""&&n.personBusiness.person.photoUrl!="/gravatar.png"&&(n.personBusiness.person.photoUrl="/"+n.personBusiness.person.photoUrl),n.personBusiness.person.hasBanner==!0&&n.personBusiness.person.bannerUrl!=null&&n.personBusiness.person.bannerUrl!=""&&(r=document.querySelector(".content-img"),u="/"+n.personBusiness.person.bannerUrl.replace(/\\/g,"/"),r.style.backgroundImage="url("+u+")"),n.personBusiness.category!=null&&n.personBusiness.category.tags!=null){let t=n.personBusiness.category.tags.map(n=>n.name);n.tagsConcatened=t.join(", ")}n.personBusiness!=null&&n.personBusiness.raffles!=null&&n.personBusiness.raffles.results.length>0?(n.list.raffles=n.personBusiness.raffles.results,n.paginantion.totalItems=n.personBusiness.raffles.totalResults,n.filter.PageNumber=n.personBusiness.raffles.pageNumber,n.paginantion.totalPages=n.personBusiness.raffles.totalPages):(n.list.raffles=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);console.log("resultado:",n.personBusiness)}else f.exibirMensagem("Atenção!","Pessoa não foi encontrada!",!1),n.addErrorAlert("Pessoa buscada não encontrada na base de dados!");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("userGalleryController",["$scope","$sce","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f,e){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.participants=[];n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={archives:[]};n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addArchive=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;$("#myModal").modal("show")};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};const o={"Content-Type":"application/json"};saveMyArchive=function(n,t){return r.post("/User/SaveMyPersonBusinessArchive",n,t)};saveMyVideo=function(n,t){return r.post("/User/SavePersonBusinesVideo",n,t)};excluirArchive=function(n){return r.post("/User/ExcluirPersonBusinessArchive",n,o)};n.save_click=function(){var t,u,r;if(n.entity.personBusinessId=n.personBusiness.id,t=new FormData($("#formElem")[0]),n.isImage==!0&&(document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png"))){if(t.append("file",n.myCroppedImage),n.myCroppedImage==null||n.myCroppedImage=="")return!1}else{const i=document.getElementById("videoFile"),n=i.files[0];if(n)t.append("videoFile",n);else return!1}u=n.entity;t.append("personBusinessArchive",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r=saveMyArchive;(n.isImage==null||n.isImage==!1)&&(r=saveMyVideo);r(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(t){var r=t.data;n.closeModal();r==!0?e.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):e.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");i.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.trustSrc=function(n){return t.trustAsResourceUrl(n)};n.getMyArchives=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");f.getMyArchives(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.personBusinessArchive!=null&&n.personBusiness.personBusinessArchive.results.length>0?(n.list.archives=n.personBusiness.personBusinessArchive.results,n.paginantion.totalItems=n.personBusiness.personBusinessArchive.totalResults,n.filter.PageNumber=n.personBusiness.personBusinessArchive.pageNumber,n.paginantion.totalPages=n.personBusiness.personBusinessArchive.totalPages):(n.list.archives=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.excludeArchive=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirArchive(t).then(function(t){var i=t.data;i==!0?e.exibirMensagem("Sucesso!","Arquivo excluído com sucesso.",!0):e.exibirMensagem("Falha","Falha ao excluir o arquivo.",!0);n.getMyArchives();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showImageToCropped=function(){n.showImageCropped=!0;e.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){e.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var s=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#imageFile")).on("change",s);n.init=function(){n.getMyArchives()};n.init()}]);