var app=angular.module("myApp",["ngSanitize","ui.select","ngTouch","ui.bootstrap","angular-loading-bar","ngAnimate","ngAria","ngMaterial","ngFileUpload","ngImgCrop","ui.mask","jkAngularRatingStars","ngLocale"]).config(["cfpLoadingBarProvider",function(n){n.parentSelector="#loading-bar-container";n.spinnerTemplate='<div style=text-align:center;><img src="/Spinerr.svg"/ height="100px"><\/div>'}]);app.config(["uiSelectConfig",function(n){n.theme="selectize"}]);app.factory("basicService",["$http",function(n){const t={"Content-Type":"application/json"};return{sendPassword:function(i){return n.post("/Home/SendPassword",i,t)},registerUser:function(i){return n.post("/Home/Register",i,t)},loginUser:function(i){return n.post("/Home/Login",i,t)},getCategories:function(){return n.get("/Home/GetCategories")},getSubCategories:function(i){return n.post("/Home/GetSubCategories",i,t)},getProductTypes:function(i){return n.post("/Home/GetProductTypes",i,t)},getTamanhos:function(i){return n.post("/Home/GetTamanhos",i,t)},getMarcas:function(i){return n.post("/Home/GetMarcas",i,t)},getCores:function(i){return n.post("/Home/GetCores",i,t)},getMyProfile:function(){return n.get("/User/GetMyProfile")},getProfile:function(i){return n.post("/Home/GetProfile",i,t)},getPersonsBusiness:function(i){return n.post("/Home/GetPersonsBusiness",i,t)},getProducts:function(i){return n.post("/Home/GetProducts",i,t)},saveMyProfile:function(i){return n.post("/User/SaveMyProfile",i,t)},updatePersonPhoto:function(t,i){return n.post("/User/UpdatePersonPhoto",t,i)},updatePersonBannerPhoto:function(t,i){return n.post("/User/UpdatePersonBannerPhoto",t,i)},saveMyBusiness:function(i){return n.post("/User/SaveMyBusiness",i,t)},saveBusinessClassification:function(i){return n.post("/Home/SaveBusinessClassification",i,t)},getRateProfileByPerson:function(i){return n.post("/Home/GetRateProfileByPerson",i,t)},getMyProducts:function(i){return n.post("/User/GetMyProducts",i,t)},getPersonBusinessProducts:function(i){return n.post("/Home/GetPersonBusinessProducts",i,t)},getMyComplements:function(i){return n.post("/User/GetMyComplements",i,t)},getMyRaffles:function(i){return n.post("/User/GetMyRaffles",i,t)},getRaffleParticipants:function(i){return n.post("/User/GetRaffleParticipants",i,t)},getProfileRaffles:function(i){return n.post("/Home/GetProfileRaffles",i,t)},savePersonBusinessCheckin:function(i){return n.post("/Home/SavePersonBusinessCheckin",i,t)},getMyArchives:function(i){return n.post("/User/GetMyArchives",i,t)},getPersonBusinessArchives:function(i){return n.post("/Home/GetPersonBusinessArchives",i,t)},getProduct:function(i){return n.post("/Home/GetProduct",i,t)},saveProductCart:function(i){return n.post("/Home/SaveProductCart",i,t)},getCart:function(i){return n.post("/Home/GetCart",i,t)},excludeCartProduct:function(i){return n.post("/User/ExcludeCartProduct",i,t)},searchCEP:function(i){return n.post("/Home/SearchCEP",i,t)},createOrder:function(i){return n.post("/Home/CreateOrder",i,t)},getOrder:function(i){return n.post("/User/GetOrder",i,t)},getOrders:function(i){return n.post("/User/GetOrders",i,t)},getProductArchives:function(i){return n.post("/Home/GetProductArchives",i,t)}}}]),function(){"use strict";function t(t,i,r){fetch(i,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(n=>{if(n.ok)return n.text();throw new Error(`${n.status} ${n.statusText} ${n.url}`);}).then(n=>{if(t.querySelector(".loading").classList.remove("d-block"),n.trim()=="OK")t.querySelector(".sent-message").classList.add("d-block"),t.reset();else throw new Error(n?n:"Form submission failed and no error message returned from: "+i);}).catch(i=>{n(t,i)})}function n(n,t){n.querySelector(".loading").classList.remove("d-block");n.querySelector(".error-message").innerHTML=t;n.querySelector(".error-message").classList.add("d-block")}let i=document.querySelectorAll(".php-email-form");i.forEach(function(i){i.addEventListener("submit",function(i){i.preventDefault();let r=this,u=r.getAttribute("action"),e=r.getAttribute("data-recaptcha-site-key");if(!u){n(r,"The form action property is not set!");return}r.querySelector(".loading").classList.add("d-block");r.querySelector(".error-message").classList.remove("d-block");r.querySelector(".sent-message").classList.remove("d-block");let f=new FormData(r);e?typeof grecaptcha!="undefined"?grecaptcha.ready(function(){try{grecaptcha.execute(e,{action:"php_email_form_submit"}).then(n=>{f.set("recaptcha-response",n),t(r,u,f)})}catch(i){n(r,i)}}):n(r,"The reCaptcha javascript API url is not loaded!"):t(r,u,f)})})}();app.controller("registerController",["$scope","basicService",function(n,t){n.user={};n.disableRegister=!1;n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.registerUser=function(){if(n.user.password!=n.user.confirmPassword)return n.addErrorAlert("As senhas devem ser idênticas!"),!1;n.disableRegister=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");t.registerUser(n.user).then(function(t){(t==undefined||t.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!"),n.disableRegister=!1);var i=t.data;i==!0?n.addSuccessAlert("Sucesso! Seus dados de acesso foram enviados ao seu e-mail!"):(n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!"),i.errorList!=null&&i.errorList.length>0&&i.errorList.map(function(t){n.addErrorAlert(t)}),n.disableRegister=!1);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! Sinto muito, não conseguimos cadastrar sua conta!");n.disableRegister=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("RecoverPasswordController",["$scope","basicService",function(n,t){n.email="";n.disableRecover=!1;n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.recoverPassword=function(){if(n.email==undefined||n.email=="")return $(".emailInput").addClass("border"),$(".emailInput").addClass("border-danger"),!1;$(".emailInput").removeClass("border");$(".emailInput").removeClass("border-danger");n.disableRecover=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");let i={username:n.email};t.sendPassword(i).then(function(t){(t==undefined||t.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!."),n.disableRecover=!1);t.data==!0?n.addSuccessAlert("Sucesso! A sua senha foi enviada no seu email."):(n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!."),n.disableRecover=!1);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! Sinto muito, não conseguimos enviar sua senha!.");n.disableRecover=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("loginController",["$scope","$window","$location","basicService",function(n,t,i,r){n.user={};n.disableLogin=!1;n.showPassword=!1;n.changeShowPassword=function(){n.showPassword=!n.showPassword};n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.loginUser=function(){n.disableLogin=!0;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.user.returnUrl=i.absUrl();r.loginUser(n.user).then(function(r){var u;if((r==undefined||r.data==undefined)&&(n.addErrorAlert("Erro! Sinto muito, falha ao realizar login!"),n.disableLogin=!1),u=r.data,u.success!=undefined&&u.success!=null&&u.success==!0){var f=i.absUrl(),e=f.split("/")[0],o=f.split("/")[2];t.location.href=u.data.startsWith("http")||u.data.startsWith("https")?e+"//"+o:e+"//"+o+u.data}else u.errorList!=null&&u.errorList.length>0&&u.errorList.map(function(t){n.addErrorAlert(t)}),n.disableLogin=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){n.addErrorAlert("Erro! não foi possível realizar login!");n.disableLogin=!1;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("orderController",["$scope","$sce","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u){n.alerts=[];n.order={};n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.loadOrder=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getOrder(t).then(function(t){var i=t.data;n.order=i;console.log(i);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.viewProduct=function(n){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");var t=i.absUrl(),r=t.split("/")[0],u=t.split("/")[2],f=r+"//"+u,t=f+"/Home/Product?Id="+n;window.open(t,"_blank");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")}}]);app.controller("orderIndexController",["$scope","$sce","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u){n.alerts=[];n.pedidos={};n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.loadOrders=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getOrders(t).then(function(t){var i=t.data;n.pedidos=i;console.log(i);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.viewOrder=function(n){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");var t=i.absUrl(),r=t.split("/")[0],u=t.split("/")[2],f=r+"//"+u,t=f+"/User/Order?Id="+n;window.open(t,"_blank");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")}}]);app.controller("userProfileController",["$scope","$filter","$window","basicService","utilidadesService",function(n,t,i,r,u){var f,e;n.myCroppedImage="";n.urlProfile="";n.showImageCropped=!1;n.tabSelected=0;n.user={};n.file=null;n.categories=[];n.categoryTags=[];n.multipleDemo={};n.multipleDemo.colors=[];n.tab=1;n.currentNavItem="page1";n.alerts=[];n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.onTabSelected=function(){n.tabSelected=n.selectedIndex};n.showImageToCropped=function(){n.showImageCropped=!0;u.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte. Caso tenha carregado, após cortar, clique no botão Atualizar foto de Perfil.",!0)};n.imageLoadError=function(){u.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};f=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#fileInput")).on("change",f);n.getMyProfile=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.getMyProfile().then(function(t){var i=t.data,r,u;i!=null&&i!=undefined&&(n.user=i);n.user.profile.personBusiness!=undefined&&n.user.profile.personBusiness!=null&&(n.user.profile.personBusiness.approved==undefined||n.user.profile.personBusiness.approved==!1)&&n.addErrorAlert("Aprovação pendente, você será notificado por e-mail e via WhatsApp(caso tenha preenchido esse campo)");n.urlProfile=n.user.profile.photoUrl+"?v="+(new Date).getTime();n.user.profile.hasBanner==!0&&n.user.profile.bannerUrl!=null&&n.user.profile.bannerUrl!=""&&(r=document.querySelector(".content-img"),u="/"+n.user.profile.bannerUrl.replace(/\\/g,"/"),r.style.backgroundImage="url("+u+")");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");n.getCategories()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.saveMyProfile=function(){var t={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};if(n.user.profile.name==""||n.user.profile.name==null)return u.exibirMensagem("Atenção!","Necessário preencher o Nome!",!1),!1;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.saveMyProfile(t).then(function(n){var t=n.data;t!=undefined&&t.success==!0?u.exibirMensagem("Atenção!","Sucesso ao atualizar seu perfil!",!1):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu perfil, entre em contato com o suporte!",!1)})};e=function(){n.$apply(function(){n.bannerArchive=document.querySelector("input[name=bannerArchive]").files[0]})};angular.element(document.querySelector("#bannerArchiveId")).on("change",e);n.updatePersonBannerPhoto=function(){var t=new FormData($("#formElem")[0]),f;if(n.bannerArchive==null||n.bannerArchive==undefined)return u.exibirMensagem("Atenção!","Necessário anexar uma imagem! Aqui mesmo na aba Banner, no campo de subir arquivo.",!1),!1;t.append("file",n.bannerArchive);f={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};t.append("user",JSON.stringify(f));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.updatePersonBannerPhoto(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(n){var t=n.data;t!=undefined&&t.success==!0?(u.exibirMensagem("Atenção!","Sucesso ao atualizar seu banner!",!1),i.location.reload()):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu banner, entre em contato com o suporte!",!1)})};n.updatePersonPhoto=function(){var t=new FormData($("#formElem")[0]),f;if(n.myImage==null||n.myImage=="")return u.exibirMensagem("Atenção!","Necessário anexar uma imagem. Para isso clique na camêra e carregue um arquivo de sua preferência.",!1),!1;t.append("file",n.myCroppedImage);f={PersonId:n.user.personId,AspNetUserId:n.user.aspNetUserId,typeUser:n.user.typeUser,Id:n.user.id,UniqueId:n.user.uniqueId,Profile:n.user.profile};t.append("user",JSON.stringify(f));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r.updatePersonPhoto(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(n){var t=n.data;t!=undefined&&t.success==!0?(u.exibirMensagem("Atenção!","Sucesso ao atualizar seu perfil!",!1),i.location.reload()):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu perfil, entre em contato com o suporte!",!1)})};n.getCategories=function(){r.getCategories().then(function(t){var i=t.data;if(i!=null&&i!=undefined&&(n.categories=i),n.categories!=null&&n.categories!=undefined){let t=n.categories.filter(function(t){return t.id===n.user.profile.personBusiness.categoryId})[0];t!=null&&t!=undefined&&(n.categoryTags=t.tags)}},function(){n.addErrorAlert("Falha ao carregar categorias. Entre em contato com o suporte!")})};n.changeCategory=function(){let t=n.categories.filter(function(t){return t.id===n.user.profile.personBusiness.categoryId})[0];n.user.profile.personBusiness.category!=null&&n.user.profile.personBusiness.category!=undefined&&(n.user.profile.personBusiness.category.tags=[]);n.categoryTags=t.tags};n.saveMyBusiness=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");(n.user.profile.personBusiness==undefined||n.user.profile.personBusiness==null)&&(n.user.profile.personBusiness={});n.user.profile.personBusiness.PersonId=n.user.profile.id;r.saveMyBusiness(n.user.profile.personBusiness).then(function(n){var t=n.data;t!=undefined&&t.success==!0?u.exibirMensagem("Atenção!","Sucesso ao atualizar seu negócio!",!1):t.errorList!=null&&t.errorList.length>0&&t.errorList.map(function(n){u.exibirMensagem("Atenção!",n,!1)});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");u.exibirMensagem("Erro no processamento","Falha ao atualizar seu negócio. Entre em contato com o suporte!",!1)})};n.init=function(){n.addSuccessAlert("Algumas imagens podem não funcionar devido seu formato ou tamanho, nesse caso faça upload da foto pelo computador ou entre em contato com nosso suporte.");n.getMyProfile()};n.init()}]);app.controller("userManagementRaffleController",["$scope","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.participants=[];n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={raffles:[]};n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addRaffle=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;$("#myModal").modal("show")};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};const e={"Content-Type":"application/json"};saveMyRaffle=function(n,t){return i.post("/User/SaveMyRaffle",n,t)};excluirSorteio=function(n){return i.post("/User/ExcluirSorteio",n,e)};n.save_click=function(){var i,r,u;n.entity.value!=null&&n.entity.value!=undefined&&typeof n.entity.value=="string"&&(i=n.entity.value.replace(".","").replace(",","."),i=parseFloat(i),n.entity.value=i);n.entity.personBusinessId=n.personBusiness.id;r=new FormData($("#formElem")[0]);(document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png"))&&r.append("file",n.myCroppedImage);u=n.entity;r.append("raffle",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");saveMyRaffle(r,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(i){var r=i.data;n.closeModal();r==!0?f.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):f.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");t.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMyRaffles=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyRaffles(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.raffles!=null&&n.personBusiness.raffles.results.length>0?(n.list.raffles=n.personBusiness.raffles.results,n.paginantion.totalItems=n.personBusiness.raffles.totalResults,n.filter.PageNumber=n.personBusiness.raffles.pageNumber,n.paginantion.totalPages=n.personBusiness.raffles.totalPages):(n.list.raffles=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.editRaffle=function(t){n.openModal();n.entity=t};n.getRaffleParticipants=function(t){n.openParticipants();n.entity=t;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getRaffleParticipants(n.entity).then(function(t){var i=t.data;console.log("resultado",i);n.participants=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.viewParticipants=function(t){n.getRaffleParticipants(t)};n.openParticipants=function(){n.participants=[];$("#modalParticipants").modal("show")};n.closeModalParticipants=function(){n.participants=[];n.entity={};$("#modalParticipants").modal("hide")};n.excludeRaffle=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirSorteio(t).then(function(t){var i=t.data;i==!0?f.exibirMensagem("Sucesso!","Sorteio excluído com sucesso.",!0):f.exibirMensagem("Falha","Falha ao excluir o sorteio.",!0);n.getMyRaffles();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showImageToCropped=function(){n.showImageCropped=!0;f.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){f.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var o=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#imageFile")).on("change",o);n.init=function(){n.getMyRaffles()};n.init()}]);app.controller("checkinController",["$scope","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5,PersonId:0};n.paginantion={totalItems:4,totalPages:0};n.list={raffles:[],sortedNumber:[]};n.personBusiness={};n.alerts=[];n.entity={};n.disableProsseguir=!1;n.tagsConcatened="";n.progressValue=0;n.addSuccessAlert=function(t){n.alerts.push({type:"primary",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.currentStep=0;n.nextPage=function(){n.currentStep<2&&n.currentStep++};n.firstPage=function(){n.currentStep=0};n.savePersonBusinessCheckin=function(){if(n.entity.instagram==null||n.entity.instagram=="")return n.addErrorAlert("Necessário por o user do Instagram!"),!1;$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.entity.personBusinessId=n.personBusiness.id;r.savePersonBusinessCheckin(n.entity).then(function(t){var i=t.data,r;i.success==!0?(n.progressValue+=1,n.addSuccessAlert(i.message),r=Object.entries(i.pedrasSorteadas),r.forEach(function(t){var i=t[0],r=t[1];n.list.sortedNumber.push({Name:i,Value:r})}),n.currentStep++):n.addErrorAlert(i.message);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");n.addErrorAlert("Erro ao fazer seu checkin!")})};n.loadProfile=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.filter.PersonId=t;r.getProfileRaffles(n.filter).then(function(t){var i=t.data,r,u;if(i!=null&&i!=undefined){if(n.personBusiness=i,n.secondRate=n.personBusiness.mediaAvaliacoes,n.personBusiness.person.photoUrl!=null&&n.personBusiness.person.photoUrl!=""&&n.personBusiness.person.photoUrl!="/gravatar.png"&&(n.personBusiness.person.photoUrl="/"+n.personBusiness.person.photoUrl),n.personBusiness.person.hasBanner==!0&&n.personBusiness.person.bannerUrl!=null&&n.personBusiness.person.bannerUrl!=""&&(r=document.querySelector(".content-img"),u="/"+n.personBusiness.person.bannerUrl.replace(/\\/g,"/"),r.style.backgroundImage="url("+u+")"),n.personBusiness.category!=null&&n.personBusiness.category.tags!=null){let t=n.personBusiness.category.tags.map(n=>n.name);n.tagsConcatened=t.join(", ")}n.personBusiness!=null&&n.personBusiness.raffles!=null&&n.personBusiness.raffles.results.length>0?(n.list.raffles=n.personBusiness.raffles.results,n.paginantion.totalItems=n.personBusiness.raffles.totalResults,n.filter.PageNumber=n.personBusiness.raffles.pageNumber,n.paginantion.totalPages=n.personBusiness.raffles.totalPages):(n.list.raffles=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);console.log("resultado:",n.personBusiness)}else f.exibirMensagem("Atenção!","Pessoa não foi encontrada!",!1),n.addErrorAlert("Pessoa buscada não encontrada na base de dados!");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})}}]);app.controller("userGalleryController",["$scope","$sce","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f,e){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.participants=[];n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={archives:[]};n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addArchive=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;$("#myModal").modal("show")};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};const o={"Content-Type":"application/json"};saveMyArchive=function(n,t){return r.post("/User/SaveMyPersonBusinessArchive",n,t)};saveMyVideo=function(n,t){return r.post("/User/SavePersonBusinesVideo",n,t)};excluirArchive=function(n){return r.post("/User/ExcluirPersonBusinessArchive",n,o)};n.save_click=function(){var t,u,r;if(n.entity.personBusinessId=n.personBusiness.id,t=new FormData($("#formElem")[0]),n.isImage==!0&&(document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png"))){if(t.append("file",n.myCroppedImage),n.myCroppedImage==null||n.myCroppedImage=="")return!1}else{const i=document.getElementById("videoFile"),n=i.files[0];if(n)t.append("videoFile",n);else return!1}u=n.entity;t.append("personBusinessArchive",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r=saveMyArchive;(n.isImage==null||n.isImage==!1)&&(r=saveMyVideo);r(t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(t){var r=t.data;n.closeModal();r==!0?e.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):e.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");i.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.trustSrc=function(n){return t.trustAsResourceUrl(n)};n.getMyArchives=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");f.getMyArchives(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.personBusinessArchive!=null&&n.personBusiness.personBusinessArchive.results.length>0?(n.list.archives=n.personBusiness.personBusinessArchive.results,n.paginantion.totalItems=n.personBusiness.personBusinessArchive.totalResults,n.filter.PageNumber=n.personBusiness.personBusinessArchive.pageNumber,n.paginantion.totalPages=n.personBusiness.personBusinessArchive.totalPages):(n.list.archives=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.excludeArchive=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirArchive(t).then(function(t){var i=t.data;i==!0?e.exibirMensagem("Sucesso!","Arquivo excluído com sucesso.",!0):e.exibirMensagem("Falha","Falha ao excluir o arquivo.",!0);n.getMyArchives();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showImageToCropped=function(){n.showImageCropped=!0;e.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){e.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var s=function(t){var r=t.currentTarget.files[0],i;n.file=r;i=new FileReader;i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})};i.readAsDataURL(r)};angular.element(document.querySelector("#imageFile")).on("change",s);n.init=function(){n.getMyArchives()};n.init()}]);app.controller("userCartController",["$scope","$sce","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u,f,e){function o(){var i=document.getElementById("numeroCartao").value,r,t;i=i.replace(/\s/g,"");r=isValid(i);r?(t=findCreditCardObjectByNumber(i),t!=null&&t.name!=""&&(t.name=="Mastercard"&&(n.bandeiraImg="img/master.png"),t.name=="Visa"&&(n.bandeiraImg="img/visa.png"),t.name=="Amex"&&(n.bandeiraImg="img/amex.png"),t.name=="Hipercard"&&(n.bandeiraImg="img/hipercard.png"),t.name=="Elo"&&(n.bandeiraImg="img/elo.png"))):n.card.numeroCartao=""}async function s(n){try{const r=`https://viacep.com.br/ws/${n}/json/`,t=await fetch(r);t.ok||e.exibirMensagem("Atenção","Erro ao consultar CEP!",!1);const i=await t.json();return i.erro&&e.exibirMensagem("Atenção","Cep não encontrado!",!1),i}catch(t){return console.error(t.message),null}}n.alerts=[];n.entity={};n.frete=0;n.valorTotal=0;n.endereco={};n.card={};n.cupom="";n.hasDigitalFrete=!1;n.cupomAplicado=!1;n.OrderEntity={};n.parcelamentos=[1,2,3,4,5,6,7,8,9,10,11,12];n.parcelamentoSelecionado=0;n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.freteResponseList=[];n.bandeiraImg="img/creditCard.png";n.loadCart=function(t){var r={},f=localStorage.getItem("cartTemporario"),i=JSON.parse(f),e;i!=null&&i.CartProducts!=null&&i.CartProducts.length>0?(t!=null&&t!=""&&(r=JSON.parse(t),r!=null&&(e=i.CartProducts.some(function(n){return n.ProductId===r.CartProducts[0].ProductId}),e||i.CartProducts.push(r.CartProducts[0]))),localStorage.setItem("cartTemporario",JSON.stringify(i))):t!=null&&t!=""&&(r=JSON.parse(t),localStorage.setItem("cartTemporario",JSON.stringify(r)));f=localStorage.getItem("cartTemporario");i=JSON.parse(f);$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getCart(i).then(function(t){var i=t.data,u,r;i!=null&&i!=undefined&&(n.entity=i,n.OrderEntity.cartId=n.entity.id,n.entity.cartProducts!=null&&n.entity.cartProducts.length>0&&(u=n.entity.cartProducts.some(function(n){return n.product.name.includes("Gift")}),u&&(n.hasDigitalFrete=!0),r=0,n.entity.cartProducts.map(function(n){r+=n.product.value}),fbq("track","InitiateCheckout",{value:r,currency:"BRL"})));$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.excludeCartProduct=function(t,i){if(t==null||t==0){var o=localStorage.getItem("cartTemporario"),r=JSON.parse(o),f=r.CartProducts.findIndex(function(n){return n.ProductId===i});f!==-1&&(r.CartProducts.splice(f,1),e.exibirMensagem("Sucesso","O produto foi excluído do carrinho",!1));localStorage.setItem("cartTemporario",JSON.stringify(r));n.loadCart()}else $(".spinerStyle").addClass("centerSpinner"),$(".spinerBackground").addClass("overlay"),u.excludeCartProduct(t).then(function(){e.exibirMensagem("Sucesso","O produto foi excluído do carrinho",!1);n.loadCart()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.showContainerCart=function(){var u=document.querySelector(".cart-container"),n,t,i,r;u.removeAttribute("hidden");n=document.querySelector(".payment-container");n.setAttribute("hidden","true");t=document.querySelector(".formaPagamento-container");t.setAttribute("hidden","true");i=document.querySelector(".register-container");i.setAttribute("hidden","true");r=document.querySelector(".meioPagamento-container");r.setAttribute("hidden","true")};n.showFormaPagamento=function(){var f=document.querySelector(".formaPagamento-container"),n,t,i,r,u;f.removeAttribute("hidden");n=document.querySelector(".frete-container");n.setAttribute("hidden","true");t=document.querySelector(".payment-container");t.setAttribute("hidden","true");i=document.querySelector(".cart-container");i.setAttribute("hidden","true");r=document.querySelector(".register-container");r.setAttribute("hidden","true");u=document.querySelector(".meioPagamento-container");u.setAttribute("hidden","true")};n.irEndereco=function(t){t==null||t==""?n.irRegistro():n.completePayment()};n.completePayment=function(){var t=!0,i,r,u,f,o,s;n.endereco.rua==null||n.endereco.rua==""?(document.querySelector('input[name="rua"]').style.border="1px solid red",t=!1):document.querySelector('input[name="rua"]').style.border="1px solid #ccc";n.endereco.numeroCasa==null||n.endereco.numeroCasa==""?(document.querySelector('input[name="numeroCasa"]').style.border="1px solid red",t=!1):document.querySelector('input[name="numeroCasa"]').style.border="1px solid #ccc";n.endereco.bairro==null||n.endereco.bairro==""?(document.querySelector('input[name="bairro"]').style.border="1px solid red",t=!1):document.querySelector('input[name="bairro"]').style.border="1px solid #ccc";n.endereco.cidade==null||n.endereco.cidade==""?(document.querySelector('input[name="cidade"]').style.border="1px solid red",t=!1):document.querySelector('input[name="cidade"]').style.border="1px solid #ccc";n.endereco.cep==null||n.endereco.cep==""?(document.querySelector('input[name="cep"]').style.border="1px solid red",t=!1):document.querySelector('input[name="cep"]').style.border="1px solid #ccc";t?(i=document.querySelector(".cart-container"),i.setAttribute("hidden","true"),r=document.querySelector(".register-container"),r.setAttribute("hidden","true"),u=document.querySelector(".formaPagamento-container"),u.setAttribute("hidden","true"),f=document.querySelector(".payment-container"),f.setAttribute("hidden","true"),o=document.querySelector(".meioPagamento-container"),o.setAttribute("hidden","true"),s=document.querySelector(".frete-container"),s.removeAttribute("hidden")):e.exibirMensagem("Atenção","Você não preencheu os campos essenciais do endereço!",!1)};n.irPagamento=function(){var f=document.querySelector(".cart-container"),n,t,i,r,u;f.setAttribute("hidden","true");n=document.querySelector(".formaPagamento-container");n.setAttribute("hidden","true");t=document.querySelector(".frete-container");t.setAttribute("hidden","true");i=document.querySelector(".meioPagamento-container");i.setAttribute("hidden","true");r=document.querySelector(".register-container");r.setAttribute("hidden","true");u=document.querySelector(".payment-container");u.removeAttribute("hidden")};n.captureBandeira=function(){o()};n.paid=function(){var t=!0,f;n.card.nomeTitular==null||n.card.nomeTitular==""?(document.querySelector('input[name="nomeTitular"]').style.border="1px solid red",t=!1):document.querySelector('input[name="nomeTitular"]').style.border="1px solid #ccc";n.card.cpfTitular==null||n.card.cpfTitular==""?(document.querySelector('input[name="cpfTitular"]').style.border="1px solid red",t=!1):document.querySelector('input[name="cpfTitular"]').style.border="1px solid #ccc";document.getElementById("numeroCartao").value==undefined||document.getElementById("numeroCartao").value==""?(document.querySelector('input[name="numeroCartao"]').style.border="1px solid red",t=!1):(document.querySelector('input[name="numeroCartao"]').style.border="1px solid #ccc",n.card.numeroCartao=document.getElementById("numeroCartao").value);n.card.validade==null||n.card.validade==""?(document.querySelector('input[name="validade"]').style.border="1px solid red",t=!1):document.querySelector('input[name="validade"]').style.border="1px solid #ccc";n.card.cvv==null||n.card.cvv==""?(document.querySelector('input[name="codigoSeguranca"]').style.border="1px solid red",t=!1):document.querySelector('input[name="codigoSeguranca"]').style.border="1px solid #ccc";n.parcelamentoSelecionado==0&&(e.exibirMensagem("Atenção","Selecione o número de parcelas!",!1),t=!1);n.card.validade.length<4&&(e.exibirMensagem("Atenção","Data de validade incorreta!",!1),t=!1);t?(f=n.freteResponseList.find(function(t){return t.id===n.entity.freteSelecionadoId}),n.OrderEntity.orderProducts=[],n.entity.cartProducts.map(function(t){var i={};i.productId=t.product.id;n.OrderEntity.orderProducts.push(i)}),n.OrderEntity.freteService=f.name,n.OrderEntity.deliveryRangeMin=f.delivery_range.min,n.OrderEntity.deliveryRangeMax=f.delivery_range.max,n.OrderEntity.fretePrice=parseFloat(f.price),n.OrderEntity.Parcelamento=n.parcelamentoSelecionado,n.OrderEntity.valorTotal=n.valorTotal,n.OrderEntity.bairro=n.endereco.bairro,n.OrderEntity.cep=n.endereco.cep,n.OrderEntity.cidade=n.endereco.cidade,n.OrderEntity.complemento=n.endereco.complemento,n.OrderEntity.numeroCasa=n.endereco.numeroCasa,n.OrderEntity.rua=n.endereco.rua,n.OrderEntity.card=n.card,$(".spinerStyle").addClass("centerSpinner"),$(".spinerBackground").addClass("overlay"),u.createOrder(n.OrderEntity).then(function(t){var f=t.data;if(f==!0){fbq("track","Purchase",{value:n.valorTotal,currency:"BRL"});var u=i.absUrl(),o=u.split("/")[0],s=u.split("/")[2],h=o+"//"+s,u=h+"/User/Orders";r.location.href=u}e.exibirMensagem("Atenção","Seu cartão não foi validado pelas questões de segurança!",!1);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})):e.exibirMensagem("Atenção","Preencha todos os dados da sua forma de pagamento!",!1)};n.calculeTotal=function(t,i){n.valorTotal=0;n.entity.freteSelecionadoId=i.id;var r=n.freteResponseList.find(function(t){return t.id===n.entity.freteSelecionadoId});n.frete=r!=null&&r.price>0?r.price:0;n.entity.cartProducts.map(function(t){n.valorTotal+=t.product.value});n.valorTotal+=parseFloat(n.frete);n.freteResponseList.map(function(n){n.colorida=!1});n.freteResponseList[t].colorida=!n.freteResponseList[t].colorida};n.irRegistro=function(t){var r,u,f,o,i,s;if(n.endereco.cep==null||n.endereco.cep=="")return document.querySelector('input[name="cep"]').style.border="1px solid red",!1;document.querySelector('input[name="cep"]').style.border="1px solid #ccc";n.entity.freteSelecionadoId!=null&&n.entity.freteSelecionadoId>0?t==null||t==""?(r=document.querySelector(".frete-container"),r.setAttribute("hidden","true"),u=document.querySelector(".formaPagamento-container"),u.setAttribute("hidden","true"),f=document.querySelector(".cart-container"),f.setAttribute("hidden","true"),i=document.querySelector(".meioPagamento-container"),i.setAttribute("hidden","true"),o=document.querySelector(".payment-container"),o.setAttribute("hidden","true"),i=document.querySelector(".meioPagamento-container"),i.setAttribute("hidden","true"),s=document.querySelector(".register-container"),s.removeAttribute("hidden")):n.irMeioPagamento():e.exibirMensagem("Atenção","É necessário selecionar um serviço de frete!",!1)};n.validadeUserToMeioPagamento=function(){var t=!0;document.getElementById("name").value==undefined||document.getElementById("name").value==""?(document.querySelector('input[name="name"]').style.border="1px solid red",t=!1):document.querySelector('input[name="name"]').style.border="1px solid #ccc";document.getElementById("username").value==undefined||document.getElementById("username").value==""?(document.querySelector('input[name="username"]').style.border="1px solid red",t=!1):document.querySelector('input[name="username"]').style.border="1px solid #ccc";t&&n.irMeioPagamento()};n.irMeioPagamento=function(){var f=document.querySelector(".frete-container"),t,i,r,u,n;f.setAttribute("hidden","true");t=document.querySelector(".formaPagamento-container");t.setAttribute("hidden","true");i=document.querySelector(".cart-container");i.setAttribute("hidden","true");n=document.querySelector(".meioPagamento-container");n.setAttribute("hidden","true");r=document.querySelector(".payment-container");r.setAttribute("hidden","true");u=document.querySelector(".register-container");u.setAttribute("hidden","true");n=document.querySelector(".meioPagamento-container");n.removeAttribute("hidden")};n.searchCEP=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.endereco.hasDigitalFrete=n.hasDigitalFrete;u.searchCEP(n.endereco).then(function(t){var i=t.data;n.freteResponseList=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.aplicarCupom=function(){n.cupomAplicado?e.exibirMensagem("Atenção","Cupom já aplicado à compra!",!1):n.hasDigitalFrete&&n.cupom=="SHOP50"&&n.cupomAplicado==!1?(n.valorTotal=n.valorTotal/2,n.cupomAplicado=!0):n.hasDigitalFrete&&n.cupom=="SHOP100"&&n.cupomAplicado==!1?(n.valorTotal=0,n.cupomAplicado=!0):e.exibirMensagem("Atenção","Cupom não reconhecido!",!1)};n.consultaViaCep=function(){console.log(n.endereco.cep);n.endereco.cep!=null&&n.endereco.cep!=""?s(n.endereco.cep).then(t=>{t!=null&&t.cep!=""?n.$apply(function(n){n.endereco.rua=t.logradouro;n.endereco.cidade=t.localidade;n.endereco.bairro=t.bairro;n.endereco.complemento=t.complemento}):e.exibirMensagem("Atenção","CEP não encontrado ou ocorreu um erro, digite manualmente.",!1)}).catch(n=>console.error(n)):e.exibirMensagem("Atenção","Cep não informado!",!1)}}]);app.controller("userManagementProductsController",["$scope","$window","$http","$filter","basicService","utilidadesService",function(n,t,i,r,u,f){n.filter={PageNumber:1,PageSize:5};n.paginantion={totalItems:4,totalPages:0};n.myCroppedImage="";n.showImageCropped=!1;n.file=null;n.entity={};n.personBusiness={};n.list={products:[]};n.categories=[];n.subcategories=[];n.productTypes=[];n.tamanhos=[];n.marcas=[];n.cores=[];n.setTab=function(t){n.tab=t};n.currentNavItem="page1";n.isSet=function(t){return n.tab===t};n.addProduct=function(){n.openModal()};n.openModal=function(){n.entity={};n.myImage="";n.myCroppedImage="";n.file=null;n.showImageCropped=!1;document.getElementById("imageFile").value=null;console.log("complementos:",n.complements);$("#myModal").modal("show")};n.productArchive={};n.closeModal=function(){n.entity={};$("#myModal").modal("hide")};n.editImages=function(t){n.entity=t;n.openModalImages()};n.openModalImages=function(){n.myCroppedImage="";n.myImage="";n.file=null;n.showImageCropped=!1;document.getElementById("productArchiveFile").value=null;n.productArchive={};n.getProductArchives();$("#modalImages").modal("show")};n.closeModalImages=function(){n.entity={};n.productArchive={};$("#modalImages").modal("hide")};const e={"Content-Type":"application/json"};saveMyProduct=function(n,t){return i.post("/User/SaveMyProduct",n,t)};saveMyProductFile=function(n,t){return i.post("/User/SaveMyProductFile",n,t)};saveProductArchive=function(n,t){return i.post("/User/SaveProductArchive",n,t)};saveProductVideo=function(n,t){return i.post("/User/SaveProductVideo",n,t)};excluirProductArchive=function(n){return i.post("/User/ExcluirProductArchive",n,e)};getProductArchives=function(n){return i.post("/Home/GetProductArchives",n,e)};excluirProduto=function(n){return i.post("/User/ExcluirProduto",n,e)};n.loadCategory=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.entity.categoryId==undefined&&(n.entity.categoryId=0);u.getSubCategories(n.entity.categoryId).then(function(t){var i=t.data;n.subcategories=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.loadSubCategory=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.entity.subCategoryId==undefined&&(n.entity.subCategoryId=0);u.getProductTypes(n.entity.subCategoryId).then(function(t){var i=t.data;n.productTypes=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getTamanhos=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getTamanhos().then(function(t){var i=t.data;n.tamanhos=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getCores=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getCores().then(function(t){var i=t.data;n.cores=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMarcas=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMarcas().then(function(t){var i=t.data;n.marcas=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getProductArchives=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");getProductArchives(n.entity).then(function(t){var i=t.data;n.entity.productArchives=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.excludeProductArchive=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirProductArchive(t).then(function(t){var i=t.data;i==!0?f.exibirMensagem("Sucesso!","Arquivo excluído com sucesso.",!0):f.exibirMensagem("Falha","Falha ao excluir o arquivo.",!0);n.closeModalImages();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.saveProductArchive=function(){var r=saveProductArchive,i=new FormData($("#formElem")[0]),u;document.getElementById("productArchiveFile").value==null||document.getElementById("productArchiveFile").value==undefined||document.getElementById("productArchiveFile").value.endsWith("jpg")||document.getElementById("productArchiveFile").value.endsWith("jpeg")||document.getElementById("productArchiveFile").value.endsWith("png")?i.append("file",n.myCroppedImage):(i.append("file",n.file),r=saveProductVideo);n.productArchive.productId=n.entity.id;u=n.productArchive;i.append("productArchive",JSON.stringify(u));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");r(i,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(i){var r=i.data;n.closeModalImages();r==!0?f.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):f.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");t.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getCategories=function(){u.getCategories().then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.categories=i)},function(){n.addErrorAlert("Falha ao carregar categorias. Entre em contato com o suporte!")})};n.save_click=function(){var r,u,i,e;n.entity.value!=null&&n.entity.value!=undefined&&typeof n.entity.value=="string"&&(r=n.entity.value.replace(".","").replace(",","."),r=parseFloat(r),n.entity.value=r);u=saveMyProduct;n.entity.personBusinessId=n.personBusiness.id;i=new FormData($("#formElem")[0]);document.getElementById("imageFile").value==null||document.getElementById("imageFile").value==undefined||document.getElementById("imageFile").value.endsWith("jpg")||document.getElementById("imageFile").value.endsWith("jpeg")||document.getElementById("imageFile").value.endsWith("png")?i.append("file",n.myCroppedImage):(i.append("file",n.file),u=saveMyProductFile);e=n.entity;i.append("product",JSON.stringify(e));$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u(i,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(i){var r=i.data;n.closeModal();r==!0?f.exibirMensagem("Sucesso!","Ação realizada com sucesso. Se tiver subido imagem, atualize sua tela para ver ela no produto!",!0):f.exibirMensagem("Falha","Falha ao realizar essa ação.",!0);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay");t.location.reload()},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getComplements=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyComplements().then(function(t){var i=t.data;n.complements=i!=null&&i.length>0?i:[];$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMyProducts=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMyProducts(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.personBusiness=i);n.personBusiness!=null&&n.personBusiness.products!=null&&n.personBusiness.products.results.length>0?(n.list.products=n.personBusiness.products.results,n.paginantion.totalItems=n.personBusiness.products.totalResults,n.filter.PageNumber=n.personBusiness.products.pageNumber,n.paginantion.totalPages=n.personBusiness.products.totalPages):(n.list.products=[],n.filter.PageNumber=1,n.paginantion.totalItems=0,n.paginantion.totalPages=0);console.log("produto",n.list.products);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.editProduct=function(t){n.openModal();n.entity=t};n.excludeProduct=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");excluirProduto(t).then(function(t){var i=t.data;i==!0?f.exibirMensagem("Sucesso!","Produto excluído com sucesso.",!0):f.exibirMensagem("Falha","Falha ao excluir o produto.",!0);n.getMyProducts();$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.addProductConfig=function(){n.entity.productConfigs==null&&(n.entity.productConfigs=[]);n.entity.productConfigs.push({})};n.excludeProductConfig=function(t){var i=n.entity.productConfigs.indexOf(t);i!==-1&&n.entity.productConfigs.splice(i,1)};n.showImageToCropped=function(){n.showImageCropped=!0;f.exibirMensagem("Imagem carregada","Se sua imagem tiver aparecido em branco, entre em contato com o suporte.",!0)};n.imageLoadError=function(){f.exibirMensagem("Erro no processamento","Essa imagem não está em um formato permitido. Entre em contato com o suporte ou tente uma imagem diferente.",!0)};var o=function(t){var r=t.currentTarget.files[0],i;n.file=r;n.file.type!="image/webp"&&(i=new FileReader,i.onload=function(t){n.$apply(function(n){n.myImage=t.target.result})},i.readAsDataURL(r))};angular.element(document.querySelector("#imageFile")).on("change",o);angular.element(document.querySelector("#productArchiveFile")).on("change",o);n.init=function(){n.getMyProducts();n.getCategories();n.loadCategory();n.loadSubCategory();n.getTamanhos();n.getMarcas();n.getCores()};n.init()}]);app.controller("LayoutController",["$scope","$location","$anchorScroll","$filter","basicService",function(n,t,i,r,u){n.filter={Category:{},CategoryId:0,SubCategoryId:0,PageNumber:1,PageSize:9};n.tags=[];n.tagSelecionada={};n.categorySelected={};n.list={products:[],categories:[],subcategories:[]};n.subcategories=[];n.productTypes=[];n.filter={categories:[],subcategories:[],productTypes:[]};n.viewSubCategory=!1;n.viewProductType=!1;n.viewCategories=!1;n.entity={totalItems:4,totalPages:0};n.scrollTo=function(n){t.hash(n);i()};n.clearFilter=function(){n.filter.Category={};n.filter.CategoryId=0;n.getProducts()};n.changeCategory=function(t){n.viewSubCategory=!0;n.viewCategories=!0;n.categorySelected=t;n.list.categories.map(function(n){n.isActive=!1});t.isActive=!0};n.voltarCategorias=function(){n.viewProductType=!1;n.viewSubCategory=!1;n.viewCategories=!0};n.voltarSubCategorias=function(){n.viewProductType=!1;n.viewSubCategory=!0};n.expandAllCategories=function(){n.viewSubCategory=!0;n.viewProductType=!1;n.viewCategories=!0;n.subcategories=[]};n.reorderCategories=function(){n.list.categories.map(function(t){t.subcategories=[];t.subcategories=r("filter")(n.list.subcategories,{categoryId:t.id});t.subcategories.map(function(t){t.productTypes=[];t.productTypes=r("filter")(n.productTypes,{subCategoryId:t.id})})});n.categorySelected=n.list.categories[0];n.categorySelected.isActive=!0};n.getCategories=function(){u.getCategories().then(function(t){var i=t.data;i!=null&&i!=undefined&&(n.list.categories=i,n.loadSubCategory(0))},function(){n.addErrorAlert("Falha ao carregar categorias. Entre em contato com o suporte!")})};n.loadSubCategory=function(t){u.getSubCategories(t).then(function(t){var i=t.data;n.list.subcategories=i;n.filter.subcategories=i;n.loadProductType(0)},function(){})};n.loadProductType=function(t){u.getProductTypes(t).then(function(t){var i=t.data;n.productTypes=i;n.filter.productTypes=i;n.reorderCategories()},function(){})};n.pesquisarProdutos=function(i){var r=t.absUrl(),u=r.split("/")[0],f=r.split("/")[2],e=u+"//"+f,r=e+"/Home/Products?ProductTypeId="+i+"&Category="+n.categorySelected.name;window.open(r,"_self")};n.init=function(){n.getCategories()};n.init()}]);app.controller("HomeController",["$scope","$location","$anchorScroll","$filter","basicService",function(n,t,i,r,u){n.filter={Category:{},CategoryId:0,SubCategoryId:0,ProductTypeId:0,Marcas:[],PageNumber:1,PageSize:5};n.list={products:[],categories:[],marcas:[]};n.entity={totalItems:4,totalPages:0};n.searchProductsByBrandAndType={};n.getMarcas=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getMarcas().then(function(t){var i=t.data;n.list.marcas=i;$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.visitProduct=function(n){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");var i=t.absUrl(),r=i.split("/")[0],u=i.split("/")[2],f=r+"//"+u,i=f+"/Home/Product?Id="+n;window.open(i,"_self");$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")};n.loadProducts=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");n.filter.ProductTypeId=t;n.filter.Marcas=r("filter")(n.list.marcas,{isSelected:!0});u.getProducts(n.filter).then(function(t){var i=t.data;i!=null&&i!=undefined&&i.results.length>0?(n.list.products=i.results,n.entity.totalItems=i.totalResults,n.filter.PageNumber=i.pageNumber,n.entity.totalPages=i.totalPages):(n.list.products=[],n.entity.totalItems=0,n.filter.PageNumber=1,n.entity.totalPages=0);console.log(n.list.products);$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.getMarcas()}]);app.controller("homeProfileController",["$scope","$sce","$location","$window","basicService","$filter","utilidadesService",function(n,t,i,r,u,f,e){n.alerts=[];n.entity={};n.addSuccessAlert=function(t){n.alerts.push({type:"success",msg:t})};n.addErrorAlert=function(t){n.alerts.push({type:"danger",msg:t})};n.closeAlert=function(t){n.alerts.splice(t,1)};n.previewImages=[];n.previewSelected="";n.previewSelectedImage="";n.quantidadeDisponivel=0;n.getProductArchives=function(){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getProductArchives(n.entity).then(function(t){var i=t.data;i.map(function(t){n.previewImages.push(n.encodeURI(t.url))});$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.encodeURI=function(n){return encodeURI(n)};n.changePreviewImage=function(t){n.previewSelected=t};n.loadProduct=function(t){$(".spinerStyle").addClass("centerSpinner");$(".spinerBackground").addClass("overlay");u.getProduct(t).then(function(t){var i=t.data;i!=null&&i!=undefined?(n.entity=i,n.previewImages.push("/"+n.entity.image),n.previewSelected="/"+n.entity.image,n.getProductArchives()):(e.exibirMensagem("Atenção!","Produto não foi encontrado!",!1),n.addErrorAlert("Produto buscado não encontrada na base de dados!"));$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")},function(){$(".spinerStyle").removeClass("centerSpinner");$(".spinerBackground").removeClass("overlay")})};n.changeCor=function(){n.entity.productTamanhos=[];n.entity.tamanhoId=null;n.quantidadeDisponivel=0;n.entity.productConfigs.map(function(t){t.corId==n.entity.colorId&&n.entity.productTamanhos.push(t.tamanho)})};n.changeTamanho=function(){n.entity.productConfigs.map(function(t){t.corId==n.entity.colorId&&t.tamanhoId==n.entity.tamanhoId&&(n.quantidadeDisponivel=t.quantidade)})};n.adicionarAoCarrinho=function(){if(n.entity.colorId==null||n.entity.colorId==0)return e.exibirMensagem("Atenção!","Selecione uma cor!",!1),!1;if(n.entity.tamanhoId==null||n.entity.tamanhoId==0)return e.exibirMensagem("Atenção!","Selecione um tamanho!",!1),!1;fbq("track","AddToCart",{value:n.entity.value,currency:"BRL"});var t=document.getElementById("meuFormulario");t.submit()}}]);